# 7月24日

## 直方图

* 直方图表示图像上像素强度的分布
* 直方图量化了每个可能取值强度的分布

![](Histogram_Equalization_Theory_0.jpg)


## 直方图均衡

* 这是一种提高图像对比度的方法，目的是为了扩展图片的强度范围
* 从上图可以看出像素的强度聚集在有效的强度之间，直方图均衡的目的是将这个范围扩大使图片看起来向下面这样，绿色的圆圈表示像素强度的密度很低，在做直方图均衡后，得到一个中心宽度更大的直方图，输出图像如下

![](Histogram_Equalization_Theory_1.jpg)

## 工作原理　

* 直方图均衡意味着将一个分布(直方图)映射到另一个分布(强度值更宽更均匀的分布)，使强度值在整个区间得到扩展
* 为了实现均衡效果，重映射应该是累计分布函数．对于直方图$H(I)$,他的累计分布函数$H^{'}(i)$为

  $$
          H^{'}(i) = \sum_{0 \le j < i} H(j)
  $$

* 为了使用这个重映射函数，我们必须对$H^{'}(i)$规范化使得它的输出最大为255(或者图像强度的最大值)，举例，一个累计分布函数如下

  ![](Histogram_Equalization_Theory_2.jpg)

* 最终，我们使用一个简单的重映射函数得到作直方图均衡的输出图像

    $$
          equalized( x, y ) = H^{'}( src(x,y) )
    $$

##  `void cv::equalizeHist()`
---
```c++
      void cv::equalizeHist(
                            InputArray      src,
                            OutputArray     dst
      )
```
---
* 计算灰度图的直方图均衡并输出到dst
* 该函数使用以下步骤计算直方图均衡

        1. 计算输出图像 src 的直方图
        2. 规范化直方图使得直方图的右闭区间为255
        3. 计算直方图的积分
        4. 将积分转化为查找表　dst(x, y) = H'(x, y)

* 该函数规范化亮度并增强图像的对比度

### 参数
---

* src        输入图像应为八位单通道
* dst        输出图像，与原图像相同的类型和尺寸
